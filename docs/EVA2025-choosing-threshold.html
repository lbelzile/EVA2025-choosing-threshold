<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-81b5c3e63835cfde897ecd3d35a35a41.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.3">

  <meta name="author" content="Léo Belzile, HEC Montréal (joint work with Sonia Alouini and Anthony Davison)">
  <title>Choosing the threshold in extreme value analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-78bf437ef0cff5db7e5240731518873b.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#002855" class="quarto-title-block center">
  <h1 class="title">Choosing the threshold in extreme value analysis</h1>
  <p class="subtitle">EVA 2025</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Léo Belzile, HEC Montréal (joint work with Sonia Alouini and Anthony Davison) 
</div>
</div>
</div>

  <p class="date">Friday, Jun 27, 2025</p>
</section>
<section id="motivation-peaks-over-threshold" class="slide level2">
<h2>Motivation: peaks over threshold</h2>
<p>In the simplest applications:</p>
<ol type="1">
<li>we choose a high threshold <span class="math inline">\(u\)</span>
<ul>
<li>equivalently, choose the number of upper order statistics <span class="math inline">\(k\equiv n_u\)</span> with threshold <span class="math inline">\(u=X_{n-k}\)</span>.</li>
</ul></li>
<li>we fit the limiting generalized Pareto distribution with scale <span class="math inline">\(\sigma_u\)</span> and shape <span class="math inline">\(\xi\)</span> to exceedances <span class="math inline">\(X-u\)</span> over threshold <span class="math inline">\(u\)</span>.
<ul>
<li>if the shape <span class="math inline">\(\xi&gt;0\)</span>, we can use rather Hill’s estimator</li>
</ul></li>
<li>we use the resulting model for extrapolation beyond <span class="math inline">\(u\)</span>.</li>
</ol>
</section>
<section id="threshold-selection" class="slide level2">
<h2>Threshold selection</h2>
<p>Bias and variance trade-off:</p>
<ul>
<li>taking <span class="math inline">\(u\)</span> too high will mean that the number of exceedances <span class="math inline">\(n_u\)</span> is small (increase uncertainty)</li>
<li>taking <span class="math inline">\(u\)</span> too low will increase <span class="math inline">\(n_u\)</span>, at the risk of a biased extrapolation.</li>
</ul>
<p>Since the limit holds as <span class="math inline">\(u\)</span> increases to the upper support point of <span class="math inline">\(X\)</span>, we must use a so-called intermediate sequence <span class="math inline">\(n_u/n\to 0\)</span> as <span class="math inline">\(n_u\to\infty\)</span> for consistency.</p>
</section>
<section id="limiting-distribution-and-threshold-stability" class="slide level2">
<h2>Limiting distribution and threshold stability</h2>
<ul>
<li>Limiting distribution of threshold exceedances is generalized Pareto.</li>
<li>If the limit was exact and <span class="math inline">\(X-u\sim \mathsf{GP}(\sigma_u,\xi)\)</span> and <span class="math inline">\(v&gt;u\)</span>, then the conditional distribution of <span class="math inline">\(X-v\)</span> given that <span class="math inline">\(X&gt;v\)</span> is also GPD, with the same shape parameter and scale parameter <span class="math inline">\(\sigma_v=\sigma_u+ \xi(v-u)\)</span>.</li>
</ul>
<p>When <span class="math inline">\(\xi&gt;-1\)</span>, we have <span class="math display">\[\mathsf{E}(X-u) = \sigma_u/(1+\xi).\]</span></p>
</section>
<section id="point-process-formulation" class="slide level2 smaller">
<h2>Point process formulation</h2>
<p>The GPD can be derived from a limiting Poisson process <span class="math inline">\({\mathcal P}\)</span> under which rare events occur in the <span class="math inline">\((t,y)\)</span>-plane with measure <span class="math display">\[\begin{align*}
\Lambda[(t',t)\times[u,\infty)] = (t_2-t_1)\{1+\xi(u-\eta)/\sigma\}^{-1/\xi}_+, \qquad \eta \in \mathbb{R}, \sigma &gt; 0.
\end{align*}\]</span></p>
<p>The vertical coordinates of <span class="math inline">\({\mathcal P}\)</span> can be generated as <span class="math display">\[\begin{align*}
\eta + \frac{\sigma}{\xi}\Bigg\{\Bigg(\sum_{j=1}^r E_j\Bigg)^{-\xi} - 1\Bigg\}, \quad r=1,2,\ldots;
\end{align*}\]</span> where the <span class="math inline">\(E_j\)</span> are independent exponential random variables.</p>
<p>Fit the Poisson process model and transform the data to a unit-rate Poisson process.</p>
<p>The choice of threshold then amounts to choosing the highest value for which the transformed observations are consistent with a unit-rate Poisson process.</p>
</section>
<section id="martingale-residuals" class="slide level2 smaller">
<h2>Martingale residuals</h2>
<p>Threshold-stability and the Markov nature of order statistics <span class="math inline">\(X_{(1)}\leq\cdots\leq X_{(n)}\)</span> of a simple random sample drawn from <span class="math inline">\(\mathsf{GP}(\sigma,\xi)\)</span> imply that the joint density of the order statistics is <span class="math display">\[\begin{equation}
\label{eq:Renyi}
\prod_{j=2}^n f(x_{(j)} \mid x_{(j-1)}) f(x_{(1)})= \prod_{j=1}^n \frac{1}{\sigma_j}\left\{1 + \frac{\xi}{n+1-j}\frac{(x_{(j)}-x_{(j-1)})}{ \sigma_j}\right\}^{-(n+1-j)/\xi-1}_+,
\end{equation}\]</span> where <span class="math inline">\(\sigma_j = (\sigma+\xi x_{j-1})/(n+1-j)\)</span> and <span class="math inline">\(x_{(0)}=0\)</span>.</p>
<p>This extends the Rényi representation for exponential data and provides a likelihood if the parameters are allowed to change at order statistics, provided that the parameters for the increment <span class="math inline">\(X_{(j)}-X_{(j-1)}\)</span> depend on the order statistics up to <span class="math inline">\(X_{(j-1)}\)</span>.</p>
<p><span class="citation" data-cites="Stein:2023">Stein (<a href="#/references" role="doc-biblioref" onclick="">2023</a>)</span> explores this idea to replace the threshold by a weighting scheme of the observations.</p>
</section>
<section id="some-problems-with-most-methods" class="slide level2">
<h2>Some problems with (most methods)</h2>
<div style="font-size: 80%;">
<p>Consider the problem of selecting a threshold amongst candidates <span class="math inline">\(u_1 &lt; \cdots &lt; u_k.\)</span></p>
<ul>
<li>Sample overlap: Data above different thresholds are overlapping (so dependence between estimates or test statistics and <span class="math inline">\(P\)</span>-values)</li>
<li>Non-nested models: peaks-over-threshold methods only consider are conditional models (so most models are not nested).</li>
<li>Multiple testing</li>
<li>Potential for automation</li>
<li>Non-stationarity</li>
</ul>
</div>
</section>
<section id="literature-review" class="slide level2">
<h2>Literature review</h2>
<p>There are earlier reviews of the topic, but the literature keeps increasing.</p>
<ul>
<li>The most comprehensive reviews are <span class="citation" data-cites="Scarrott.MacDonald:2012">Scarrott and MacDonald (<a href="#/references" role="doc-biblioref" onclick="">2012</a>)</span>, <span class="citation" data-cites="Caeiro.Gomes:2016">Caeiro and Gomes (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span> and <span class="citation" data-cites="Langousis:2016">Langousis et al. (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span>.</li>
<li>Select numerical comparisons in <span class="citation" data-cites="Gomes.Oliveira:2001">Gomes and Oliveira (<a href="#/references" role="doc-biblioref" onclick="">2001</a>)</span>, <span class="citation" data-cites="Murphy.Tawn.Varty:2024">Murphy, Tawn, and Varty (<a href="#/references" role="doc-biblioref" onclick="">2025</a>)</span> and <span class="citation" data-cites="Schneider:2021">Schneider, Krajina, and Krivobokova (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span>, among others.</li>
</ul>
</section>
<section id="objective" class="slide level2">
<h2>Objective</h2>
<p>We provide an extensive review of threshold selection mechanisms for peak over threshold analysis, including</p>
<ul>
<li>semiparametric methods based on Hill’s estimator,</li>
<li>visual diagnostics,</li>
<li>goodness-of-fit tests,</li>
<li>extended generalized Pareto models.</li>
</ul>
</section>
<section id="how-to-benchmark-methods" class="slide level2">
<h2>How to benchmark methods?</h2>
<p>In practice, we care about</p>
<ul>
<li>the extrapolation, often a high quantile (return level), or</li>
<li>a probability of exceedance.</li>
</ul>
<p>Benchmarking the method based on proximity with the asymptotic shape parameter is not a good point of reference.</p>
<p>Scale and shape parameters are negatively correlated.</p>
</section>
<section id="penultimate-effects" class="slide level2">
<h2>Penultimate effects</h2>
<p><span class="citation" data-cites="smith_1987">Smith (<a href="#/references" role="doc-biblioref" onclick="">1987</a>)</span> show that a better approximation is obtained by letting the shape vary with <span class="math inline">\(u\)</span>, with <span class="math display">\[\xi_t = r'(u),\]</span> where <span class="math display">\[r(t) = \{1-F(t)\}/f(t)\]</span> is the reciprocal hazard function.</p>
</section>
<section id="illustration-of-penultimate-effects-normal-example" class="slide level2 smaller">
<h2>Illustration of penultimate effects: normal example</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/penultimate_normal.png" class="quarto-figure quarto-figure-center" style="width:70.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/Fig-penultimate_normal.png" class="quarto-figure quarto-figure-center" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="graphical-procedures" class="slide level2">
<h2>Graphical procedures</h2>
<p>Generalized Pareto distribution is threshold stable (shape is constant).</p>
<ul>
<li>Mean residual life plots <span class="citation" data-cites="Davison.Smith:1990">(<a href="#/references" role="doc-biblioref" onclick="">Davison and Smith 1990</a>)</span></li>
<li>Threshold stability plots</li>
<li>Hill plots; see, e.g., <span class="citation" data-cites="Resnick:2007">Resnick (<a href="#/references" role="doc-biblioref" onclick="">2007</a>)</span></li>
</ul>
</section>
<section id="visual-diagnostics-on-padova-data" class="slide level2">
<h2>Visual diagnostics on Padova data</h2>

<img data-src="figures/Fig_padova_visualdiag.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"><p>Which threshold would you choose?</p>
</section>
<section id="caveats" class="slide level2">
<h2>Caveats</h2>
<ul>
<li>Difficulty in automating selection (need visual inspection); proposals in <span class="citation" data-cites="Langousis:2016">Langousis et al. (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span> or <span class="citation" data-cites="Danielsson:2019">Danielsson et al. (<a href="#/references" role="doc-biblioref" onclick="">2019</a>)</span>, but both fall short.</li>
<li>sample overlap leads to dependence between estimates (pointwise confidence intervals) + multiple testing</li>
<li>affected by penultimate effects (shape varies with <span class="math inline">\(u\)</span> in practice)</li>
<li>plots say nothing about goodness-of-fit!</li>
</ul>
</section>
<section id="stability" class="slide level2 smaller">
<h2>Stability?</h2>

<img data-src="figures/Fig-tstabplots4.png" class="quarto-figure quarto-figure-center r-stretch" style="width:60.0%"><p>Hill, PORT and random block maxima <span class="citation" data-cites="Wager:2014">(<a href="#/references" role="doc-biblioref" onclick="">Wager 2014</a>)</span> estimates as a function of <span class="math inline">\(k\)</span> (sample paths of RBM are <span class="math inline">\(\mathcal{C}^{\infty}\)</span>).</p>
</section>
<section id="generalized-pareto-model-extensions" class="slide level2">
<h2>Generalized Pareto model extensions</h2>
<p>Build extended models with additional parameters (with continuity constraints) and test for equality of shape</p>
<p><span class="citation" data-cites="Northrop.Coleman:2014">Northrop and Coleman (<a href="#/references" role="doc-biblioref" onclick="">2014</a>)</span>: piecewise generalized Pareto model, score tests for equality.</p>
<ul>
<li>tests are dependent because the data are re-used; no control of overall error rate.</li>
<li>the power of the test depends on the choice of thresholds and especially on <span class="math inline">\(u_K\)</span>.</li>
</ul>
</section>
<section id="extended-generalized-pareto-models" class="slide level2 smaller">
<h2>Extended generalized Pareto models</h2>
<p>Embed generalized Pareto <span class="math inline">\(F(x;\sigma,\xi)\)</span> in a more flexible model with the same tail properties using a continuous distribution function <span class="math inline">\(G_\kappa\)</span> on <span class="math inline">\([0,1]\)</span> <span class="citation" data-cites="Naveau:2025">(<a href="#/references" role="doc-biblioref" onclick="">Naveau 2025</a>)</span>.</p>
<p>The EGP<span class="math inline">\((\sigma,\xi, G_\kappa)\)</span> distribution function is then <span class="math display">\[\begin{align*}
\Pr(X\leq x) = G_\kappa\{ F(x;\sigma,\xi)\}.                     \end{align*}\]</span></p>
<ul>
<li><span class="citation" data-cites="Papastathopoulos.Tawn:2013">Papastathopoulos and Tawn (<a href="#/references" role="doc-biblioref" onclick="">2013</a>)</span>: models imply the density at the origin is zero.</li>
<li><span class="citation" data-cites="Gamet.Jalbert:2022">Gamet and Jalbert (<a href="#/references" role="doc-biblioref" onclick="">2022</a>)</span> (propose two models, but non-regular asymptotics).</li>
</ul>
</section>
<section id="extended-generalized-pareto-models-1" class="slide level2">
<h2>Extended generalized Pareto models</h2>
<p>Test for restriction to generalized Pareto sub-model using likelihood ratio tests (profile).</p>
<ul>
<li>Could allow for a bit more data to be included, at the expense of additional parameters to estimate.</li>
<li>Same problems as parameter stability plots (sequential tests, overlapping data).</li>
</ul>
</section>
<section id="splicing-models" class="slide level2">
<h2>Splicing models</h2>
<p>Glue a distribution for the bulk with one for the tail using a mixture of disjoint components below <span class="math inline">\(u\)</span> (bulk) and above <span class="math inline">\(u\)</span> (generalized Pareto). See <span class="citation" data-cites="Scarrott.MacDonald:2012">Scarrott and MacDonald (<a href="#/references" role="doc-biblioref" onclick="">2012</a>)</span> and <span class="citation" data-cites="Hu.Scarrott:2018">Hu and Scarrott (<a href="#/references" role="doc-biblioref" onclick="">2018</a>)</span>.</p>
<ul>
<li>Leads to sample contamination, fit may be driven by bulk.</li>
<li>profile likelihood for threshold <span class="math inline">\(u\)</span> is non-monotone.</li>
<li>Bayesian version (random threshold) leads to threshold selection uncertainty.</li>
</ul>
</section>
<section id="goodness-of-fit-measures" class="slide level2">
<h2>Goodness-of-fit measures</h2>
<ol type="1">
<li>Fit a generalized Pareto distribution at each threshold <span class="math inline">\(u_1&lt; \cdots &lt; u_k\)</span></li>
<li>Compute either
<ul>
<li>a suitable statistic which indicates departure from the posulated distribution</li>
<li>a measure of discrepancy between empirical distribution of exceedances above <span class="math inline">\(u\)</span> and generalized Pareto model (via Kolmogorov–Smirnov, Cramér–von Mises, etc.)</li>
</ul></li>
<li>Perform tests sequentially until rejection.</li>
</ol>
<p>Can also be done on quantile scale <span class="citation" data-cites="Danielsson:2019">(<a href="#/references" role="doc-biblioref" onclick="">Danielsson et al. 2019</a>)</span>.</p>
</section>
<section id="some-proposals" class="slide level2">
<h2>Some proposals</h2>
<ul>
<li>Idea dates back to <span class="citation" data-cites="Pickands:1975">Pickands (<a href="#/references" role="doc-biblioref" onclick="">1975</a>)</span>.</li>
<li><span class="citation" data-cites="Choulakian.Stephens:2001">Choulakian and Stephens (<a href="#/references" role="doc-biblioref" onclick="">2001</a>)</span>, <span class="citation" data-cites="Bader.Yan.Zhang:2018">Bader, Yan, and Zhang (<a href="#/references" role="doc-biblioref" onclick="">2018</a>)</span> (using ForwardStop)</li>
<li>Recent proposals using <span class="math inline">\(L\)</span>-moment estimators including <span class="citation" data-cites="Kiran.Srinivas:2021">Kiran and Srinivas (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span>, <span class="citation" data-cites="Solari:2017">Solari et al. (<a href="#/references" role="doc-biblioref" onclick="">2017</a>)</span>, <span class="citation" data-cites="SilvaLomba.FragaAlves:2020">Silva Lomba and Fraga Alves (<a href="#/references" role="doc-biblioref" onclick="">2020</a>)</span>.</li>
</ul>
</section>
<section id="testing-using-maximum-likelihood-distribution" class="slide level2">
<h2>Testing using maximum likelihood distribution</h2>
<p><span class="citation" data-cites="Thompson:2009">Thompson et al. (<a href="#/references" role="doc-biblioref" onclick="">2009</a>)</span> propose using constant values <span class="math display">\[\tau_j = \widehat{\sigma}_j - \widehat{\xi}_j u_j\]</span> and performing Pearson’s test of normality for the differences <span class="math inline">\(\tau_{j+1} - \tau_{j}\)</span> (<span class="math inline">\(j=1, \ldots, k-1\)</span>), stopping whenever the hypothesis is rejected at level <span class="math inline">\(\alpha = 0.2\)</span>.</p>
</section>
<section id="sequential-analysis" class="slide level2">
<h2>Sequential analysis</h2>
<p><span class="citation" data-cites="Wadsworth:2016">Wadsworth (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span> obtains asymptotic joint distribution of MLE from a superposition of Poisson processes.</p>
<p>Build independent increments of shape to form a white noise sequence <span class="math inline">\(\xi^*_i=(\hat{\xi}_{u_{i+1}}-\hat{\xi}_{u_i})/\{(I^{-1}_{u_{i+1}}-I^{-1}_{u_{i}})_{\xi,\xi}^{1/2}\}\)</span>.</p>
<ul>
<li>Parameter stability plots with simultaneous confidence intervals!</li>
<li>White noise test for <span class="math inline">\(\xi^*_i\)</span>, with alternative <span class="math inline">\(\mathscr{H}_a: \xi^*_i \sim \mathsf{Normal}(\beta, \sigma) (i=1, \ldots, j-1)\)</span> and <span class="math inline">\(\xi^*_i \sim \mathsf{Normal}(0,1)\)</span> for <span class="math inline">\(j, \ldots, k-1\)</span> motivated by results on model misspecification <span class="citation" data-cites="White:1982">(<a href="#/references" role="doc-biblioref" onclick="">White 1982</a>)</span>.</li>
</ul>
</section>
<section id="comments-on-wadsworth-2016" class="slide level2">
<h2>Comments on Wadsworth (2016)</h2>
<p>Fails 17% of the time in our simulations with equally spaced quantiles.</p>
<ul>
<li>Problems with positive definiteness of information matrices for shape increments.</li>
<li>Method sensitive to rounding.</li>
<li>Must choose the threshold sequence <span class="math inline">\(u_1 \leq \cdots u_k\)</span> carefully.</li>
</ul>
</section>
<section id="bayesian-measures-of-surprise" class="slide level2 smaller">
<h2>Bayesian measures of surprise</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><span class="citation" data-cites="Lee:2015">Lee, Fan, and Sisson (<a href="#/references" role="doc-biblioref" onclick="">2015</a>)</span> propose constructing a threshold stability plot showing Bayesian <span class="math inline">\(p\)</span>-value for a summary statistic against thresholds, capturing the agreement between sample and simulated data from the posterior distribution.</p>
<p>Under null hypothesis, <span class="math inline">\(p\)</span>-values should be around 0.5.</p>
<ul>
<li>Need replications to assess null distribution (very computationally intensive).</li>
<li>Choice of statistic matters!</li>
</ul>
</div><div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/Fig-tstabplots3.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="predictive-distribution" class="slide level2 smaller">
<h2>Predictive distribution</h2>
<p><span class="citation" data-cites="Northrop.Attalides.Jonathan:2017">Northrop, Attalides, and Jonathan (<a href="#/references" role="doc-biblioref" onclick="">2017</a>)</span> propose a related Bayesian method based on leave-one-out cross validation with a binomial-generalized Pareto (BGP) model and a single validation threshold <span class="math inline">\(v &gt; u_k\)</span> above which we assess the model performance.</p>
<p>The measure of goodness-of-fit proposed is an estimate of the negated Kullback–Leibler divergence, <span class="math display">\[\begin{align*}
\widehat{T}_v(u_i) = \sum_{i=1}^n \log\{ \widehat{f}_v(x_r \mid \boldsymbol{x}_{-r}, u_i)\}.
\end{align*}\]</span> The selected threshold is the one among the candidates maximizing this diagnostic.</p>
<p>Further propose using Bayesian model averaging to account for the uncertainty originating from threshold selection.</p>
</section>
<section id="metric-based-diagnostic" class="slide level2">
<h2>Metric-based diagnostic</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div style="font-size: 80%;">
<p>Build quantile-quantile (QQ-) plot, with pointwise confidence intervals can be obtained using a parametric bootstrap.</p>
<p>Each bootstrap sample <span class="math inline">\(b=1, \ldots, B\)</span>, estimate the empirical quantile function <span class="math inline">\(F_{b}\)</span>, which is evaluated at the plotting position <span class="math inline">\(p_i=i/(n+1)\)</span> for <span class="math inline">\(i=1, \ldots, n.\)</span></p>
<p><span class="citation" data-cites="Varty.Tawn:2021">Varty et al. (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span> and <span class="citation" data-cites="Murphy.Tawn.Varty:2024">Murphy, Tawn, and Varty (<a href="#/references" role="doc-biblioref" onclick="">2025</a>)</span> propose repeating this with simulated iid data from <span class="math inline">\(F_0\)</span> (tolerance intervals).</p>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/Varty2021.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="metric-based-adjustment" class="slide level2">
<h2>Metric-based adjustment</h2>
<p>Build metric based on exponential (or generalized Pareto quantile <span class="math inline">\(F_0^{-1}\{p_i\}\)</span> against <span class="math inline">\(F^{-1}_{b}(p_i)\)</span> with mean absolute difference or mean squared difference.</p>
<p>Pick the threshold with the smallest average distance is chosen.</p>
<ul>
<li>amenable to different sampling schemes (censoring, non-identically distributed data, time-varying thresholds).</li>
<li>computationally-intensive by design.</li>
</ul>
</section>
<section id="simulation-study-comparison-of-methods" class="slide level2 smaller">
<h2>Simulation study: comparison of methods</h2>
<p>We considered 13 different distributions from simulation studies in <span class="citation" data-cites="Choulakian.Stephens:2001">Choulakian and Stephens (<a href="#/references" role="doc-biblioref" onclick="">2001</a>)</span> and <span class="citation" data-cites="Schneider:2021">Schneider, Krajina, and Krivobokova (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span>.</p>
<ul>
<li>Consider 1000 replications of IID data, data with serial correlation in the tail, rounded observations.</li>
<li>Data of size <span class="math inline">\(n\in \{1000, 2000\}\)</span> with candidate thresholds at the sample <span class="math inline">\(\{0.8, 0.81, \ldots, 0.99\}\)</span> quantiles, keeping a minimum of 20 exceedances.</li>
<li>Evaluate bias, variance, RMSE of point estimator for 0.999 quantile.</li>
<li>Compare to oracle (model with the closest quantile estimate among candidates).</li>
</ul>
</section>
<section id="which-quantile-level-on-average" class="slide level2">
<h2>Which quantile level on average?</h2>

<img data-src="figures/thresh_simulation1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:70.0%"></section>
<section id="findings" class="slide level2">
<h2>Findings</h2>
<ul>
<li>No universally better method.</li>
<li>Goodness-of-fit tests null distributions require adjustment for rounded values (estimate null via Monte Carlo).</li>
<li>Many of the automated procedures return the lowest possible threshold.</li>
<li>Using Forward stop method to account for multiple testing leads to thresholds that are much lower.</li>
</ul>
</section>
<section id="more-comments" class="slide level2 smaller">
<h2>More comments</h2>
<ul>
<li>Mean residual life plots are uniformly scattered.</li>
<li>Varty metric diagnostic also leads to very small thresholds (mean is near 80%).</li>
<li><span class="citation" data-cites="Northrop.Attalides.Jonathan:2017">Northrop, Attalides, and Jonathan (<a href="#/references" role="doc-biblioref" onclick="">2017</a>)</span> and <span class="citation" data-cites="Thompson:2009">Thompson et al. (<a href="#/references" role="doc-biblioref" onclick="">2009</a>)</span> lead to much less agreement and a greater variability of selected quantile levels for the thresholds. For the cross-validation approach, this is in line with findings of <span class="citation" data-cites="Murphy.Tawn.Varty:2024">Murphy, Tawn, and Varty (<a href="#/references" role="doc-biblioref" onclick="">2025</a>)</span>.</li>
<li>The oracle method returns value that are on average between the 87% and the 90% quantile.</li>
<li>Wadsworth’s sequential testing performs best with heavy tailed distributions, but otherwise is one of the worst in terms of ranking.</li>
</ul>
</section>
<section id="conclusions-and-future-work" class="slide level2">
<h2>Conclusions and future work</h2>
<ul>
<li>Is the problem well-formulated? There is no “correct” threshold, so are we barking up the wrong tree?</li>
<li>Weighting with different threshold choices to account for uncertainty.</li>
<li>Should we be fitting sub-asymptotic models to much more data?</li>
</ul>
</section>
<section id="semiparametric-methods" class="slide level2">
<h2>Semiparametric methods</h2>
<p>The paper also compares 18 different semiparametric methods using Hill-type estimator for heavy-tailed data.</p>
<ul>
<li>Careful: many numerical implementations don’t specify a minimum sample size!</li>
<li>Primer: methods based on minimization of the asymptotic mean squared error of the Hill estimator <span class="citation" data-cites="Caeiro.Gomes:2016">(<a href="#/references" role="doc-biblioref" onclick="">Caeiro and Gomes 2016</a>)</span>, or the double nonparametric bootstrap scheme <span class="citation" data-cites="Gomes.Figueiredo.Neves:2012">Gomes, Figueiredo, and Neves (<a href="#/references" role="doc-biblioref" onclick="">2012</a>)</span>, and random block maxima estimator of <span class="citation" data-cites="Wager:2014">Wager (<a href="#/references" role="doc-biblioref" onclick="">2014</a>)</span> with empirical risk minimization perform best.</li>
</ul>
</section>
<section id="dont-use-the-following" class="slide level2 smaller">
<h2>Don’t use the following</h2>
<ul>
<li>Methods based on minimization of the asymptotic mean squared error can break down catastrophically for particular data sets.</li>
<li>Methods by <span class="citation" data-cites="Gomes:2013">Gomes et al. (<a href="#/references" role="doc-biblioref" onclick="">2013</a>)</span> and <span class="citation" data-cites="Hall.Welsh:1985">Hall and Welsh (<a href="#/references" role="doc-biblioref" onclick="">1985</a>)</span> behave erratically with small shape parameters: these procedures lead to strongly biased shape parameter estimates. This is due to them keeping more than 15% of the data for inference.</li>
<li><span class="citation" data-cites="Drees.Kaufmann:1998">Drees and Kaufmann (<a href="#/references" role="doc-biblioref" onclick="">1998</a>)</span> bias-reduction method leads to small number of order statistics, with very large width of the confidence intervals (unwanted variability).</li>
<li>Many other methods are extremely variable.</li>
</ul>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Bader.Yan.Zhang:2018" class="csl-entry" role="listitem">
Bader, Brian, Jun Yan, and Xuebin Zhang. 2018. <span>“Automated Threshold Selection for Extreme Value Analysis via Ordered Goodness-of-Fit Tests with Adjustment for False Discovery Rate.”</span> <em>The Annals of Applied Statistics</em> 12 (1): 310–29. <a href="https://doi.org/10.1214/17-aoas1092">https://doi.org/10.1214/17-aoas1092</a>.
</div>
<div id="ref-Caeiro.Gomes:2016" class="csl-entry" role="listitem">
Caeiro, Frederico, and M. Ivette Gomes. 2016. <span>“Threshold Selection in Extreme Value Analysis.”</span> In <em>Extreme Value Modeling and Risk Analysis: Methods and Applications</em>, edited by Dipak K. Dey and Jun Yan, 69–86. Boca Raton, FL: CRC Press. <a href="https://doi.org/10.1201/b19721">https://doi.org/10.1201/b19721</a>.
</div>
<div id="ref-Choulakian.Stephens:2001" class="csl-entry" role="listitem">
Choulakian, V, and M. A Stephens. 2001. <span>“Goodness-of-Fit Tests for the Generalized <span>P</span>areto Distribution.”</span> <em>Technometrics</em> 43 (4): 478–84. <a href="https://doi.org/10.1198/00401700152672573">https://doi.org/10.1198/00401700152672573</a>.
</div>
<div id="ref-Danielsson:2019" class="csl-entry" role="listitem">
Danielsson, Jon, Lerby Ergun, Casper G. de Vries, and Laurens de Haan. 2019. <span>“Tail Index Estimation: Quantile-Driven Threshold Selection.”</span> <a href="https://doi.org/10.34989/swp-2019-28">https://doi.org/10.34989/swp-2019-28</a>.
</div>
<div id="ref-Davison.Smith:1990" class="csl-entry" role="listitem">
Davison, A. C., and R. L. Smith. 1990. <span>“Models for Exceedances over High Thresholds (with Discussion).”</span> <em>Journal of the Royal Statistical Society. Series B. (Methodological)</em> 52 (3): 393–442. <a href="https://doi.org/10.1111/j.2517-6161.1990.tb01796.x">https://doi.org/10.1111/j.2517-6161.1990.tb01796.x</a>.
</div>
<div id="ref-Drees.Kaufmann:1998" class="csl-entry" role="listitem">
Drees, Holger, and Edgar Kaufmann. 1998. <span>“Selecting the Optimal Sample Fraction in Univariate Extreme Value Estimation.”</span> <em>Stochastic Processes and Their Applications</em> 75 (2): 149–72. <a href="https://doi.org/10.1016/s0304-4149(98)00017-9">https://doi.org/10.1016/s0304-4149(98)00017-9</a>.
</div>
<div id="ref-Gamet.Jalbert:2022" class="csl-entry" role="listitem">
Gamet, Philémon, and Jonathan Jalbert. 2022. <span>“A Flexible Extended Generalized Pareto Distribution for Tail Estimation.”</span> <em>Environmetrics</em> 33 (6). <a href="https://doi.org/10.1002/env.2744">https://doi.org/10.1002/env.2744</a>.
</div>
<div id="ref-Gomes.Figueiredo.Neves:2012" class="csl-entry" role="listitem">
Gomes, M. Ivette, Fernanda Figueiredo, and M. Manuela Neves. 2012. <span>“Adaptive Estimation of Heavy Right Tails: Resampling-Based Methods in Action.”</span> <em>Extremes</em> 15 (4): 463–89. <a href="https://doi.org/10.1007/s10687-011-0146-6">https://doi.org/10.1007/s10687-011-0146-6</a>.
</div>
<div id="ref-Gomes:2013" class="csl-entry" role="listitem">
Gomes, M. Ivette, Lı́gia Henriques-Rodrigues, M. Isabel Fraga Alves, and B. G. Manjunath. 2013. <span>“Adaptive <span>PORT</span>–<span>MVRB</span> Estimation: An Empirical Comparison of Two Heuristic Algorithms.”</span> <em>Journal of Statistical Computation and Simulation</em> 83 (6): 1129–44. <a href="https://doi.org/10.1080/00949655.2011.652113">https://doi.org/10.1080/00949655.2011.652113</a>.
</div>
<div id="ref-Gomes.Oliveira:2001" class="csl-entry" role="listitem">
Gomes, M. Ivette, and Orlando Oliveira. 2001. <span>“The Bootstrap Methodology in Statistics of Extremes—Choice of the Optimal Sample Fraction.”</span> <em>Extremes</em> 4 (4): 331–58. <a href="https://doi.org/10.1023/a:1016592028871">https://doi.org/10.1023/a:1016592028871</a>.
</div>
<div id="ref-Hall.Welsh:1985" class="csl-entry" role="listitem">
Hall, Peter, and A. H. Welsh. 1985. <span>“Adaptive Estimates of Parameters of Regular Variation.”</span> <em>The Annals of Statistics</em> 13 (1): 331–41. <a href="https://doi.org/10.1214/aos/1176346596">https://doi.org/10.1214/aos/1176346596</a>.
</div>
<div id="ref-Hu.Scarrott:2018" class="csl-entry" role="listitem">
Hu, Yang, and Carl Scarrott. 2018. <span>“<code>evmix</code>: An <span>R</span> Package for Extreme Value Mixture Modeling, Threshold Estimation and Boundary Corrected Kernel Density Estimation.”</span> <em>Journal of Statistical Software</em> 84 (5): 1–27. <a href="https://doi.org/10.18637/jss.v084.i05">https://doi.org/10.18637/jss.v084.i05</a>.
</div>
<div id="ref-Kiran.Srinivas:2021" class="csl-entry" role="listitem">
Kiran, K. G., and V. V. Srinivas. 2021. <span>“A <span>M</span>ahalanobis Distance-Based Automatic Threshold Selection Method for Peaks over Threshold Model.”</span> <em>Water Resources Research</em> 57 (e2020WR027534). <a href="https://doi.org/10.1029/2020wr027534">https://doi.org/10.1029/2020wr027534</a>.
</div>
<div id="ref-Langousis:2016" class="csl-entry" role="listitem">
Langousis, Andreas, Antonios Mamalakis, Michelangelo Puliga, and Roberto Deidda. 2016. <span>“Threshold Detection for the Generalized <span>P</span>areto Distribution: Review of Representative Methods and Application to the <span>NOAA</span> <span>NCDC</span> Daily Rainfall Database.”</span> <em>Water Resources Research</em> 52 (4): 2659–81. https://doi.org/<a href="https://doi.org/10.1002/2015WR018502">https://doi.org/10.1002/2015WR018502</a>.
</div>
<div id="ref-Lee:2015" class="csl-entry" role="listitem">
Lee, J., Y. Fan, and S. A. Sisson. 2015. <span>“Bayesian Threshold Selection for Extremal Models Using Measures of Surprise.”</span> <em>Computational Statistics &amp; Data Analysis</em> 85: 84–99. <a href="https://doi.org/10.1016/j.csda.2014.12.004">https://doi.org/10.1016/j.csda.2014.12.004</a>.
</div>
<div id="ref-Murphy.Tawn.Varty:2024" class="csl-entry" role="listitem">
Murphy, Conor, Jonathan A. Tawn, and Zak Varty. 2025. <span>“Automated Threshold Selection and Associated Inference Uncertainty for Univariate Extremes.”</span> <em>Technometrics</em> 67 (2): 215–24. <a href="https://doi.org/10.1080/00401706.2024.2421744">https://doi.org/10.1080/00401706.2024.2421744</a>.
</div>
<div id="ref-Naveau:2025" class="csl-entry" role="listitem">
Naveau, P. 2025. <span>“Jointly Modeling Bulk and Tails.”</span> In <em>Handbook of Statistics of Extremes</em>, edited by M. de Carvalho, R. Huser, P. Naveau, and B. J. and Reich, to appear. Boca Raton: Chapman &amp; Hall/CRC.
</div>
<div id="ref-Northrop.Attalides.Jonathan:2017" class="csl-entry" role="listitem">
Northrop, Paul J., Nicolas Attalides, and Philip Jonathan. 2017. <span>“Cross-Validatory Extreme Value Threshold Selection and Uncertainty with Application to Ocean Storm Severity.”</span> <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em> 66 (1): 93–120. https://doi.org/<a href="https://doi.org/10.1111/rssc.12159">https://doi.org/10.1111/rssc.12159</a>.
</div>
<div id="ref-Northrop.Coleman:2014" class="csl-entry" role="listitem">
Northrop, Paul J., and Claire L. Coleman. 2014. <span>“Improved Threshold Diagnostic Plots for Extreme Value Analyses.”</span> <em>Extremes</em> 17 (2): 289–303. <a href="https://doi.org/10.1007/s10687-014-0183-z">https://doi.org/10.1007/s10687-014-0183-z</a>.
</div>
<div id="ref-Papastathopoulos.Tawn:2013" class="csl-entry" role="listitem">
Papastathopoulos, Ioannis, and Jonathan A. Tawn. 2013. <span>“Extended Generalised <span>P</span>areto Models for Tail Estimation.”</span> <em>Journal of Statistical Planning and Inference</em> 143 (1): 131–43. <a href="https://doi.org/10.1016/j.jspi.2012.07.001">https://doi.org/10.1016/j.jspi.2012.07.001</a>.
</div>
<div id="ref-Pickands:1975" class="csl-entry" role="listitem">
Pickands, James. 1975. <span>“Statistical Inference Using Extreme Order Statistics.”</span> <em>The Annals of Statistics</em> 3: 119–31. <a href="https://doi.org/10.1214/aos/1176343003">https://doi.org/10.1214/aos/1176343003</a>.
</div>
<div id="ref-Resnick:2007" class="csl-entry" role="listitem">
Resnick, Sidney I. 2007. <em>Heavy-Tail Phenomena</em>. New York: Springer.
</div>
<div id="ref-Scarrott.MacDonald:2012" class="csl-entry" role="listitem">
Scarrott, Carl, and Anna MacDonald. 2012. <span>“A Review of Extreme-Value Threshold Estimation and Uncertainty Quantification.”</span> <em>REVSTAT – Statistical Journal</em> 10 (1): 33–60. <a href="https://doi.org/10.57805/revstat.v10i1.110">https://doi.org/10.57805/revstat.v10i1.110</a>.
</div>
<div id="ref-Schneider:2021" class="csl-entry" role="listitem">
Schneider, Laura Fee, Andrea Krajina, and Tatyana Krivobokova. 2021. <span>“Threshold Selection in Univariate Extreme Value Analysis.”</span> <em>Extremes</em> 24 (4): 881–913. <a href="https://doi.org/10.1007/s10687-021-00405-7">https://doi.org/10.1007/s10687-021-00405-7</a>.
</div>
<div id="ref-SilvaLomba.FragaAlves:2020" class="csl-entry" role="listitem">
Silva Lomba, Jessica, and Maria Isabel Fraga Alves. 2020. <span>“<span class="math inline">\(L\)</span>-Moments for Automatic Threshold Selection in Extreme Value Analysis.”</span> <em>Stochastic Environmental Research and Risk Assessment</em> 34 (3): 465–91. <a href="https://doi.org/10.1007/s00477-020-01789-x">https://doi.org/10.1007/s00477-020-01789-x</a>.
</div>
<div id="ref-smith_1987" class="csl-entry" role="listitem">
Smith, Richard L. 1987. <span>“Approximations in Extreme Value Theory.”</span> Department of Statistics; Operations Research, University of North Carolina. <a href="https://lbelzile.bitbucket.io/papers/Smith-1987-Approximations_in_extreme_value_theory.pdf">https://lbelzile.bitbucket.io/papers/Smith-1987-Approximations_in_extreme_value_theory.pdf</a>.
</div>
<div id="ref-Solari:2017" class="csl-entry" role="listitem">
Solari, Sebastián, Marta Egüen, Marı́a José Polo, and Miguel A. Losada. 2017. <span>“Peaks over Threshold (<span>POT</span>): A Methodology for Automatic Threshold Estimation Using Goodness of Fit <span class="math inline">\(p\)</span>-Value.”</span> <em>Water Resources Research</em> 53 (4): 2833–49. <a href="https://doi.org/10.1002/2016wr019426">https://doi.org/10.1002/2016wr019426</a>.
</div>
<div id="ref-Stein:2023" class="csl-entry" role="listitem">
Stein, Michael L. 2023. <span>“A Weighted Composite Log-Likelihood Approach to Parametric Estimation of the Extreme Quantiles of a Distribution.”</span> <em>Extremes</em> 26: 469–507. <a href="https://doi.org/10.1007/s10687-023-00466-w">https://doi.org/10.1007/s10687-023-00466-w</a>.
</div>
<div id="ref-Thompson:2009" class="csl-entry" role="listitem">
Thompson, Paul, Yuzhi Cai, Dominic Reeve, and Julian Stander. 2009. <span>“Automated Threshold Selection Methods for Extreme Wave Analysis.”</span> <em>Coastal Engineering</em> 56 (10): 1013–21. https://doi.org/<a href="https://doi.org/10.1016/j.coastaleng.2009.06.003">https://doi.org/10.1016/j.coastaleng.2009.06.003</a>.
</div>
<div id="ref-Varty.Tawn:2021" class="csl-entry" role="listitem">
Varty, Zak, Jonathan A. Tawn, Peter M. Atkinson, and Stijn Bierman. 2021. <span>“Inference for Extreme Earthquake Magnitudes Accounting for a Time-Varying Measurement Process.”</span> <a href="https://doi.org/10.48550/arXiv.2102.00884">https://doi.org/10.48550/arXiv.2102.00884</a>.
</div>
<div id="ref-Wadsworth:2016" class="csl-entry" role="listitem">
Wadsworth, J. L. 2016. <span>“Exploiting Structure of Maximum Likelihood Estimators for Extreme Value Threshold Selection.”</span> <em>Technometrics</em> 58 (1): 116–26. <a href="https://doi.org/10.1080/00401706.2014.998345">https://doi.org/10.1080/00401706.2014.998345</a>.
</div>
<div id="ref-Wager:2014" class="csl-entry" role="listitem">
Wager, Stefan. 2014. <span>“Subsampling Extremes: From Block Maxima to Smooth Tail Estimation.”</span> <em>Journal of Multivariate Analysis</em> 130: 335–53. <a href="https://doi.org/10.1016/j.jmva.2014.06.010">https://doi.org/10.1016/j.jmva.2014.06.010</a>.
</div>
<div id="ref-White:1982" class="csl-entry" role="listitem">
White, Halbert. 1982. <span>“Maximum Likelihood Estimation of Misspecified Models.”</span> <em>Econometrica</em> 50 (1): 1–25. <a href="https://doi.org/10.2307/1912526">https://doi.org/10.2307/1912526</a>.
</div>
</div>
</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="figures/logo_hec_montreal_bleu_web.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-text-resizer/revealjs-text-resizer.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealTextResizer, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>